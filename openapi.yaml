openapi: 3.1.0

info:
  title: OnlyFans API Dashboard External API
  description: >
    External API for accessing OnlyFans model data, analytics, chats,
    payouts, and statistics through a secure multi-tenant platform.
  version: 1.0.0
  termsOfService: https://yourdomain.com/terms
  contact:
    email: support@yourdomain.com
    url: https://yourdomain.com/support
  license:
    name: Proprietary
    url: https://yourdomain.com/license

servers:
  - url: https://api.yourdomain.com/api/v1/onlyfans
    description: Production server
  - url: http://localhost:3000/api/v1/onlyfans
    description: Development server

paths:
  /organizations/{orgId}/models:
    get:
      summary: Get organization models
      description: Retrieve all models associated with a specific organization.
      operationId: getOrganizationModels
      tags: [Organizations]
      parameters:
        - $ref: "#/components/parameters/OrgId"
      responses:
        "200":
          description: Organization models retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "500":
          $ref: "#/components/responses/InternalServerError"

    post:
      summary: Process organization models
      description: Create or update models for a specific organization.
      operationId: postOrganizationModels
      tags: [Organizations]
      parameters:
        - $ref: "#/components/parameters/OrgId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
      responses:
        "200":
          description: Models processed successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

  /models/{modelId}/reconnect:
    post:
      summary: Reconnect model
      description: Reconnect and refresh the model data connection.
      operationId: reconnectModel
      tags: [Models]
      parameters:
        - $ref: "#/components/parameters/ModelId"
      responses:
        "200":
          description: Model reconnected successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

  /models/{modelId}/users/me:
    get:
      summary: Get model details
      description: Retrieve detailed information for a specific model.
      operationId: getModelDetails
      tags: [Models]
      parameters:
        - $ref: "#/components/parameters/ModelId"
      responses:
        "200":
          description: Model details retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

  /models/{modelId}/fans/info:
    get:
      summary: Get fan details
      description: Retrieve detailed information about a specific fan.
      operationId: getFanDetails
      tags: [Fans]
      parameters:
        - $ref: "#/components/parameters/ModelId"
        - name: user_id
          in: query
          required: true
          description: Unique identifier of the fan
          schema:
            type: string
      responses:
        "200":
          description: Fan details retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

  /models/{modelId}/chats:
    get:
      summary: Get model chats
      description: Retrieve chat conversations for a model with pagination.
      operationId: getModelChats
      tags: [Chats]
      parameters:
        - $ref: "#/components/parameters/ModelId"
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
        - name: offset
          in: query
          schema:
            type: integer
            default: 0
      responses:
        "200":
          description: Chats retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

  /models/{modelId}/chats/{chatId}/messages:
    get:
      summary: Get chat messages
      description: Retrieve messages from a specific chat conversation.
      operationId: getChatMessages
      tags: [Chats]
      parameters:
        - $ref: "#/components/parameters/ModelId"
        - $ref: "#/components/parameters/ChatId"
        - name: limit
          in: query
          schema:
            type: integer
            default: 50
      responses:
        "200":
          description: Chat messages retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

  /models/{modelId}/payouts/transactions:
    get:
      summary: Get payout transactions
      description: Retrieve payout transaction history for a model.
      operationId: getModelPayoutTransactions
      tags: [Payouts]
      parameters:
        - $ref: "#/components/parameters/ModelId"
      responses:
        "200":
          description: Payout transactions retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

  /models/{modelId}/payouts/statistics:
    get:
      summary: Get payout statistics
      description: Retrieve payout statistics within a date range.
      operationId: getModelPayoutStats
      tags: [Payouts]
      parameters:
        - $ref: "#/components/parameters/ModelId"
        - $ref: "#/components/parameters/StartDate"
        - $ref: "#/components/parameters/EndDate"
      responses:
        "200":
          description: Payout statistics retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

  /models/{modelId}/payouts/requests/referral:
    get:
      summary: Get payout referral requests
      description: Retrieve referral-based payout requests for a model.
      operationId: getModelPayoutReferralRequests
      tags: [Payouts]
      parameters:
        - $ref: "#/components/parameters/ModelId"
      responses:
        "200":
          description: Referral payout requests retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

  /models/{modelId}/statistics/balances:
    get:
      summary: Get payout balances
      description: Retrieve current payout balances for a model.
      operationId: getModelPayoutBalances
      tags: [Statistics]
      parameters:
        - $ref: "#/components/parameters/ModelId"
      responses:
        "200":
          description: Payout balances retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

  /models/{modelId}/statistics/overview:
    get:
      summary: Get statistics overview
      description: Retrieve overall performance statistics for a model.
      operationId: getModelStatsOverview
      tags: [Statistics]
      parameters:
        - $ref: "#/components/parameters/ModelId"
        - $ref: "#/components/parameters/StartDate"
        - $ref: "#/components/parameters/EndDate"
      responses:
        "200":
          description: Statistics overview retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

  /models/{modelId}/stats/reach:
    get:
      summary: Get reach statistics
      description: Retrieve audience reach statistics for a model.
      operationId: getModelReachStats
      tags: [Statistics]
      parameters:
        - $ref: "#/components/parameters/ModelId"
        - $ref: "#/components/parameters/StartDate"
        - $ref: "#/components/parameters/EndDate"
      responses:
        "200":
          description: Reach statistics retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

  /models/{modelId}/stats/reach/by-country:
    get:
      summary: Get reach statistics by country
      description: Retrieve reach statistics grouped by country.
      operationId: getModelReachStatsByCountry
      tags: [Statistics]
      parameters:
        - $ref: "#/components/parameters/ModelId"
        - $ref: "#/components/parameters/StartDate"
        - $ref: "#/components/parameters/EndDate"
      responses:
        "200":
          description: Reach statistics by country retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

  /models/{modelId}/stats/fans:
    get:
      summary: Get fan statistics
      description: Retrieve fan-related statistics for a model.
      operationId: getModelFansStats
      tags: [Statistics]
      parameters:
        - $ref: "#/components/parameters/ModelId"
        - $ref: "#/components/parameters/StartDate"
        - $ref: "#/components/parameters/EndDate"
      responses:
        "200":
          description: Fan statistics retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

  /models/{modelId}/stats/fans/top:
    get:
      summary: Get top fans
      description: Retrieve top fans for a model.
      operationId: getModelTopFans
      tags: [Statistics]
      parameters:
        - $ref: "#/components/parameters/ModelId"
        - $ref: "#/components/parameters/StartDate"
        - $ref: "#/components/parameters/EndDate"
      responses:
        "200":
          description: Top fans retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

components:
  schemas:
    ApiResponse:
      type: object
      required: [success, message]
      properties:
        success:
          type: boolean
        message:
          type: string
        data:
          nullable: true
        metadata:
          type: object
        statusCode:
          type: integer
        responseTime:
          type: number

    ErrorResponse:
      type: object
      required: [success, message, error, statusCode]
      properties:
        success:
          type: boolean
        message:
          type: string
        error:
          type: string
        statusCode:
          type: integer

  parameters:
    OrgId:
      name: orgId
      in: path
      required: true
      schema:
        type: string

    ModelId:
      name: modelId
      in: path
      required: true
      schema:
        type: string

    ChatId:
      name: chatId
      in: path
      required: true
      schema:
        type: string

    StartDate:
      name: startDate
      in: query
      schema:
        type: string
        format: date

    EndDate:
      name: endDate
      in: query
      schema:
        type: string
        format: date

  responses:
    BadRequest:
      description: Bad request
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"

    Unauthorized:
      description: Unauthorized
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"

    InternalServerError:
      description: Internal server error
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"

  securitySchemes:
    ApiKeyAuth:
      type: http
      scheme: bearer
      description: Bearer token authentication

    XApiKeyAuth:
      type: apiKey
      in: header
      name: X-API-Key
      description: External API key authentication

tags:
  - name: Organizations
  - name: Models
  - name: Fans
  - name: Chats
  - name: Payouts
  - name: Statistics

security:
  - ApiKeyAuth: []
    XApiKeyAuth: []
