openapi: 3.1.0

info:
  title: OnlyFans API Dashboard External API
  description: >
    External API for accessing OnlyFans model data, analytics, and management
    features through a secure multi-tenant platform.
  version: 1.0.0
  termsOfService: https://yourdomain.com/terms
  contact:
    email: support@yourdomain.com
    url: https://yourdomain.com/support
  license:
    name: Proprietary
    url: https://yourdomain.com/license

servers:
  - url: https://api.yourdomain.com/api/v1/onlyfans
    description: Production server
  - url: http://localhost:3000/api/v1/onlyfans
    description: Development server

paths:
  /organizations/{orgId}/models:
    get:
      summary: Get organization models
      description: Retrieve all models associated with a specific organization.
      operationId: getOrganizationModels
      tags: [Organizations]
      parameters:
        - $ref: "#/components/parameters/OrgId"
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"
              examples:
                success:
                  $ref: "#/components/examples/GetOrganizationModelsResponseExample"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "500":
          $ref: "#/components/responses/InternalServerError"

    post:
      summary: Process organization models
      description: Process or update models for a specific organization.
      operationId: postOrganizationModels
      tags: [Organizations]
      parameters:
        - $ref: "#/components/parameters/OrgId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

  /models/{modelId}/reconnect:
    post:
      summary: Reconnect model
      description: Reconnect and refresh model data connection.
      operationId: reconnectModel
      tags: [Models]
      parameters:
        - $ref: "#/components/parameters/ModelId"
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

  /models/{modelId}/users/me:
    get:
      summary: Get model details
      operationId: getModelDetails
      tags: [Models]
      parameters:
        - $ref: "#/components/parameters/ModelId"
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

  /models/{modelId}/fans/info:
    get:
      summary: Get fan details
      operationId: getFanDetails
      tags: [Fans]
      parameters:
        - $ref: "#/components/parameters/ModelId"
        - name: user_id
          in: query
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

  /models/{modelId}/chats:
    get:
      summary: Get model chats
      operationId: getModelChats
      tags: [Chats]
      parameters:
        - $ref: "#/components/parameters/ModelId"
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
        - name: offset
          in: query
          schema:
            type: integer
            default: 0
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

  /models/{modelId}/chats/{chatId}/messages:
    get:
      summary: Get chat messages
      operationId: getChatMessages
      tags: [Chats]
      parameters:
        - $ref: "#/components/parameters/ModelId"
        - $ref: "#/components/parameters/ChatId"
        - name: limit
          in: query
          schema:
            type: integer
            default: 50
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

  /models/{modelId}/payouts/statistics:
    get:
      summary: Get payout statistics
      operationId: getModelPayoutStats
      tags: [Payouts]
      parameters:
        - $ref: "#/components/parameters/ModelId"
        - $ref: "#/components/parameters/StartDate"
        - $ref: "#/components/parameters/EndDate"
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

components:
  schemas:
    ApiResponse:
      type: object
      properties:
        success:
          type: boolean
        message:
          type: string
        data:
          nullable: true
        metadata:
          type: object
        statusCode:
          type: integer
        responseTime:
          type: number
      required: [success, message]

    ErrorResponse:
      type: object
      required: [success, message, error, statusCode]
      properties:
        success:
          type: boolean
        message:
          type: string
        error:
          type: string
        statusCode:
          type: integer

  parameters:
    OrgId:
      name: orgId
      in: path
      required: true
      schema:
        type: string

    ModelId:
      name: modelId
      in: path
      required: true
      schema:
        type: string

    ChatId:
      name: chatId
      in: path
      required: true
      schema:
        type: string

    StartDate:
      name: startDate
      in: query
      schema:
        type: string
        format: date

    EndDate:
      name: endDate
      in: query
      schema:
        type: string
        format: date

  responses:
    BadRequest:
      description: Bad request
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"

    Unauthorized:
      description: Unauthorized
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"

    InternalServerError:
      description: Internal server error
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"

  examples:
    GetOrganizationModelsResponseExample:
      value:
        success: true
        message: Organization models retrieved successfully
        data:
          - id: model_abc123
            name: Model Name
        statusCode: 200

  securitySchemes:
    ApiKeyAuth:
      type: http
      scheme: bearer
      description: Bearer token authentication

    XApiKeyAuth:
      type: apiKey
      in: header
      name: X-API-Key
      description: External API key for tenant access

tags:
  - name: Organizations
  - name: Models
  - name: Fans
  - name: Chats
  - name: Payouts
  - name: Statistics

security:
  - ApiKeyAuth: []
    XApiKeyAuth: []
