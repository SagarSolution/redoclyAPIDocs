openapi: 3.1.0

info:
  title: OnlyFans API Dashboard External API
  description: >
    External API for accessing OnlyFans model data, analytics, chats,
    payouts, and statistics through a secure multi-tenant platform.
  version: 1.0.0
  termsOfService: https://yourdomain.com/terms
  contact:
    email: support@yourdomain.com
    url: https://yourdomain.com/support
  license:
    name: Proprietary
    url: https://yourdomain.com/license

servers:
  - url: https://api.yourdomain.com/api/v1
    description: Production server
  - url: http://localhost:3000/api/v1
    description: Development server

paths:
  # Organization Management Endpoints
  /organizations:
    post:
      summary: Create organization
      description: Create a new organization for managing OnlyFans API access.
      operationId: createOrganization
      tags: [Organizations]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name]
              properties:
                name:
                  type: string
                  description: Organization name
                description:
                  type: string
                  description: Organization description
      responses:
        "201":
          description: Organization created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "500":
          $ref: "#/components/responses/InternalServerError"

    get:
      summary: List organizations
      description: Retrieve all organizations accessible to the authenticated user.
      operationId: listOrganizations
      tags: [Organizations]
      responses:
        "200":
          description: Organizations retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "500":
          $ref: "#/components/responses/InternalServerError"

  /organizations/{orgId}:
    get:
      summary: Get organization details
      description: Retrieve details of a specific organization.
      operationId: getOrganization
      tags: [Organizations]
      parameters:
        - $ref: "#/components/parameters/OrgId"
      responses:
        "200":
          description: Organization details retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          description: Organization not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          $ref: "#/components/responses/InternalServerError"

    put:
      summary: Update organization
      description: Update organization details.
      operationId: updateOrganization
      tags: [Organizations]
      parameters:
        - $ref: "#/components/parameters/OrgId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  description: Organization name
                description:
                  type: string
                  description: Organization description
      responses:
        "200":
          description: Organization updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          description: Organization not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          $ref: "#/components/responses/InternalServerError"

    delete:
      summary: Delete organization
      description: Delete an organization and all associated API keys.
      operationId: deleteOrganization
      tags: [Organizations]
      parameters:
        - $ref: "#/components/parameters/OrgId"
      responses:
        "200":
          description: Organization deleted successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          description: Organization not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          $ref: "#/components/responses/InternalServerError"

  # API Key Management Endpoints
  /organizations/{orgId}/api-keys:
    post:
      summary: Create API key
      description: Create a new API key for accessing OnlyFans APIs within an organization.
      operationId: createApiKey
      tags: [API Keys]
      parameters:
        - $ref: "#/components/parameters/OrgId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name]
              properties:
                name:
                  type: string
                  description: API key name for identification
                description:
                  type: string
                  description: API key description
                expiresAt:
                  type: string
                  format: date-time
                  description: Optional expiration date for the API key
      responses:
        "201":
          description: API key created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          description: Organization not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          $ref: "#/components/responses/InternalServerError"

    get:
      summary: List API keys
      description: Retrieve all API keys for an organization.
      operationId: listApiKeys
      tags: [API Keys]
      parameters:
        - $ref: "#/components/parameters/OrgId"
      responses:
        "200":
          description: API keys retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          description: Organization not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          $ref: "#/components/responses/InternalServerError"

  /organizations/{orgId}/api-keys/{keyId}:
    get:
      summary: Get API key details
      description: Retrieve details of a specific API key.
      operationId: getApiKey
      tags: [API Keys]
      parameters:
        - $ref: "#/components/parameters/OrgId"
        - $ref: "#/components/parameters/KeyId"
      responses:
        "200":
          description: API key details retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          description: API key or organization not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          $ref: "#/components/responses/InternalServerError"

    put:
      summary: Update API key
      description: Update API key details (name, description, expiration).
      operationId: updateApiKey
      tags: [API Keys]
      parameters:
        - $ref: "#/components/parameters/OrgId"
        - $ref: "#/components/parameters/KeyId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  description: API key name
                description:
                  type: string
                  description: API key description
                expiresAt:
                  type: string
                  format: date-time
                  description: Expiration date for the API key
      responses:
        "200":
          description: API key updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          description: API key or organization not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          $ref: "#/components/responses/InternalServerError"

    delete:
      summary: Delete API key
      description: Delete an API key.
      operationId: deleteApiKey
      tags: [API Keys]
      parameters:
        - $ref: "#/components/parameters/OrgId"
        - $ref: "#/components/parameters/KeyId"
      responses:
        "200":
          description: API key deleted successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          description: API key or organization not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          $ref: "#/components/responses/InternalServerError"

  # OnlyFans API Endpoints
  /onlyfans/organizations/{orgId}/models:
    get:
      summary: Get organization models
      description: Retrieve all models associated with a specific organization.
      operationId: getOrganizationModels
      tags: [OnlyFans - Organizations]
      parameters:
        - $ref: "#/components/parameters/OrgId"
      responses:
        "200":
          description: Organization models retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "500":
          $ref: "#/components/responses/InternalServerError"

    post:
      summary: Process organization models
      description: Create or update models for a specific organization.
      operationId: postOrganizationModels
      tags: [OnlyFans - Organizations]
      parameters:
        - $ref: "#/components/parameters/OrgId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
      responses:
        "200":
          description: Models processed successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

  /onlyfans/models/{modelId}/reconnect:
    post:
      summary: Reconnect model
      description: Reconnect and refresh the model data connection.
      operationId: reconnectModel
      tags: [OnlyFans - Models]
      parameters:
        - $ref: "#/components/parameters/ModelId"
      responses:
        "200":
          description: Model reconnected successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

  /onlyfans/models/{modelId}/users/me:
    get:
      summary: Get model details
      description: Retrieve detailed information for a specific model.
      operationId: getModelDetails
      tags: [OnlyFans - Models]
      parameters:
        - $ref: "#/components/parameters/ModelId"
      responses:
        "200":
          description: Model details retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

  /onlyfans/models/{modelId}/fans/info:
    get:
      summary: Get fan details
      description: Retrieve detailed information about a specific fan.
      operationId: getFanDetails
      tags: [OnlyFans - Fans]
      parameters:
        - $ref: "#/components/parameters/ModelId"
        - name: user_id
          in: query
          required: true
          description: Unique identifier of the fan
          schema:
            type: string
      responses:
        "200":
          description: Fan details retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

  /onlyfans/models/{modelId}/chats:
    get:
      summary: Get model chats
      description: Retrieve chat conversations for a model with pagination.
      operationId: getModelChats
      tags: [OnlyFans - Chats]
      parameters:
        - $ref: "#/components/parameters/ModelId"
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
        - name: offset
          in: query
          schema:
            type: integer
            default: 0
      responses:
        "200":
          description: Chats retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

  /onlyfans/models/{modelId}/chats/{chatId}/messages:
    get:
      summary: Get chat messages
      description: Retrieve messages from a specific chat conversation.
      operationId: getChatMessages
      tags: [OnlyFans - Chats]
      parameters:
        - $ref: "#/components/parameters/ModelId"
        - $ref: "#/components/parameters/ChatId"
        - name: limit
          in: query
          schema:
            type: integer
            default: 50
      responses:
        "200":
          description: Chat messages retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

  /onlyfans/models/{modelId}/payouts/transactions:
    get:
      summary: Get payout transactions
      description: Retrieve payout transaction history for a model.
      operationId: getModelPayoutTransactions
      tags: [OnlyFans - Payouts]
      parameters:
        - $ref: "#/components/parameters/ModelId"
      responses:
        "200":
          description: Payout transactions retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

  /onlyfans/models/{modelId}/payouts/statistics:
    get:
      summary: Get payout statistics
      description: Retrieve payout statistics within a date range.
      operationId: getModelPayoutStats
      tags: [OnlyFans - Payouts]
      parameters:
        - $ref: "#/components/parameters/ModelId"
        - $ref: "#/components/parameters/StartDate"
        - $ref: "#/components/parameters/EndDate"
      responses:
        "200":
          description: Payout statistics retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

  /onlyfans/models/{modelId}/payouts/requests/referral:
    get:
      summary: Get payout referral requests
      description: Retrieve referral-based payout requests for a model.
      operationId: getModelPayoutReferralRequests
      tags: [OnlyFans - Payouts]
      parameters:
        - $ref: "#/components/parameters/ModelId"
      responses:
        "200":
          description: Referral payout requests retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

  /onlyfans/models/{modelId}/statistics/balances:
    get:
      summary: Get payout balances
      description: Retrieve current payout balances for a model.
      operationId: getModelPayoutBalances
      tags: [OnlyFans - Statistics]
      parameters:
        - $ref: "#/components/parameters/ModelId"
      responses:
        "200":
          description: Payout balances retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

  /onlyfans/models/{modelId}/statistics/overview:
    get:
      summary: Get statistics overview
      description: Retrieve overall performance statistics for a model.
      operationId: getModelStatsOverview
      tags: [OnlyFans - Statistics]
      parameters:
        - $ref: "#/components/parameters/ModelId"
        - $ref: "#/components/parameters/StartDate"
        - $ref: "#/components/parameters/EndDate"
      responses:
        "200":
          description: Statistics overview retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

  /onlyfans/models/{modelId}/stats/reach:
    get:
      summary: Get reach statistics
      description: Retrieve audience reach statistics for a model.
      operationId: getModelReachStats
      tags: [OnlyFans - Statistics]
      parameters:
        - $ref: "#/components/parameters/ModelId"
        - $ref: "#/components/parameters/StartDate"
        - $ref: "#/components/parameters/EndDate"
      responses:
        "200":
          description: Reach statistics retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

  /onlyfans/models/{modelId}/stats/reach/by-country:
    get:
      summary: Get reach statistics by country
      description: Retrieve reach statistics grouped by country.
      operationId: getModelReachStatsByCountry
      tags: [OnlyFans - Statistics]
      parameters:
        - $ref: "#/components/parameters/ModelId"
        - $ref: "#/components/parameters/StartDate"
        - $ref: "#/components/parameters/EndDate"
      responses:
        "200":
          description: Reach statistics by country retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

  /onlyfans/models/{modelId}/stats/fans:
    get:
      summary: Get fan statistics
      description: Retrieve fan-related statistics for a model.
      operationId: getModelFansStats
      tags: [OnlyFans - Statistics]
      parameters:
        - $ref: "#/components/parameters/ModelId"
        - $ref: "#/components/parameters/StartDate"
        - $ref: "#/components/parameters/EndDate"
      responses:
        "200":
          description: Fan statistics retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

  /onlyfans/models/{modelId}/stats/fans/top:
    get:
      summary: Get top fans
      description: Retrieve top fans for a model.
      operationId: getModelTopFans
      tags: [OnlyFans - Statistics]
      parameters:
        - $ref: "#/components/parameters/ModelId"
        - $ref: "#/components/parameters/StartDate"
        - $ref: "#/components/parameters/EndDate"
      responses:
        "200":
          description: Top fans retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"

components:
  schemas:
    ApiResponse:
      type: object
      required: [success, message]
      properties:
        success:
          type: boolean
        message:
          type: string
        data:
          type: object
        metadata:
          type: object
        statusCode:
          type: integer
        responseTime:
          type: number

    ErrorResponse:
      type: object
      required: [success, message, error, statusCode]
      properties:
        success:
          type: boolean
        message:
          type: string
        error:
          type: string
        statusCode:
          type: integer

  parameters:
    OrgId:
      name: orgId
      in: path
      required: true
      schema:
        type: string

    ModelId:
      name: modelId
      in: path
      required: true
      schema:
        type: string

    ChatId:
      name: chatId
      in: path
      required: true
      schema:
        type: string

    KeyId:
      name: keyId
      in: path
      required: true
      schema:
        type: string

    StartDate:
      name: startDate
      in: query
      schema:
        type: string
        format: date

    EndDate:
      name: endDate
      in: query
      schema:
        type: string
        format: date

  responses:
    BadRequest:
      description: Bad request
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"

    Unauthorized:
      description: Unauthorized
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"

    InternalServerError:
      description: Internal server error
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"

  securitySchemes:
    ApiKeyAuth:
      type: http
      scheme: bearer
      description: Bearer token authentication for admin operations

    XApiKeyAuth:
      type: apiKey
      in: header
      name: X-API-Key
      description: API key authentication for OnlyFans API access

tags:
  - name: Organizations
    description: Organization management operations
  - name: API Keys
    description: API key management within organizations
  - name: OnlyFans - Organizations
    description: OnlyFans organization model operations
  - name: OnlyFans - Models
    description: OnlyFans model operations
  - name: OnlyFans - Fans
    description: OnlyFans fan operations
  - name: OnlyFans - Chats
    description: OnlyFans chat operations
  - name: OnlyFans - Payouts
    description: OnlyFans payout operations
  - name: OnlyFans - Statistics
    description: OnlyFans statistics operations

security:
  - ApiKeyAuth: []
  - XApiKeyAuth: []
